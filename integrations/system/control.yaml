# Multi-instance control. Defines what instances control what automations

script:
  mqtt_discovery:
    use_blueprint:
      path: yuri-vashchenko/generate_mqtt_discovery.yaml
      input:
        discovery_prefix: "test-discovery-prefix"
        component: "test-component"
        object_id: "test-object-id"
        payload: "test-payload"



  # binary_sensor:
  #   - platform: mqtt
  #     name: server_main_control_mode
  #     state_topic: "instance/main/control"
  #     payload_on: "ON"
  #     payload_off: "OFF"
  #   - platform: mqtt
  #     name: server_backup_control_mode
  #     state_topic: "instance/backup/control"
  #     payload_on: "ON"
  #     payload_off: "OFF"

  # switch:
  #   - platform: template
  #     switches:
  #       control_mode:
  #         friendly_name: "Режим управления"
  #         value_template: "{{ is_state('binary_sensor.server_backup_control_mode', 'on') }}"
  #         turn_on:
  #           service: mqtt.publish
  #           data_template:
  #             topic: "instance/backup/control"
  #             payload_template: 'ON'
  #             retain: true 
  #         turn_off:
  #           service: mqtt.publish
  #           data_template:
  #             topic: "instance/backup/control"
  #             payload_template: 'OFF'
  #             retain: true 
  #         icon_template: >-
  #           {% if is_state('switch.control_mode', 'on') %}
  #             mdi:server
  #           {% else %}
  #             mdi:server-off
  #           {% endif %}
  #       control_mode_other:
  #         friendly_name: "Режим управления"
  #         value_template: "{{ is_state('binary_sensor.server_main_control_mode', 'on') }}"
  #         turn_on:
  #           service: mqtt.publish
  #           data_template:
  #             topic: "instance/main/control"
  #             payload_template: 'ON'
  #             retain: true 
  #         turn_off:
  #           service: mqtt.publish
  #           data_template:
  #             topic: "instance/main/control"
  #             payload_template: 'OFF'
  #             retain: true 
  #         icon_template: >-
  #           {% if is_state('switch.control_mode_other', 'on') %}
  #             mdi:server
  #           {% else %}
  #             mdi:server-off
  #           {% endif %}
